<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Farcompra</title>
    <script src="static/js/script.js"></script>
    <script src="https://unpkg.com/htmx.org@1.9.11"></script>
</head>
<body>
    <h1>Welcome to farcompra Pedro bastidas</h1>
    <h3><a href="{{ url_for('admin.index') }}">Go to the admin panel</a></h3>

    <h3><a href="{{ url_for('logout') }}">Logout.</a></h3>
    <h2>All products</h2>
    <form id="filter_form">
        <input id="input_search" type="text" placeholder="Type Product Name or Barcode" autocomplete="off"  name="q"
               hx-get="/search" hx-trigger="keyup changed delay:500ms" hx-target="#search_container">
    </form>
    <div id="search_container">
        <ul id="results">
            {% for product in products %}
                <li style="cursor:pointer" onclick="toggleListItem(this)">{{ product.name }}</li>

                <ul id="prices" style="display:none">
                    {% for price in product.prices %}
                        <li>
                            {{ price.supplier_info.name }}:
                            <br>
                            ${{ "%.2f" |format(price.price) }}
                            vence: {{ price.due_date  }}
                            stock: {{ price.stock }}
                        </li>
                    {% endfor %}
                </ul>
            {% endfor %}
        </ul>
        <!--pagination-->
        {% for page in products.iter_pages() %}
            {% if page %}
                {% if page != products.page %}
                    <a href="{{ url_for('index', page=page) }}">{{ page }}</a>
                {% else %}
                <strong>{{ page }}</strong>
                {% endif %}
            {% else %}
                <span class=ellipsis>â€¦</span>
            {% endif %}
        {% endfor %}
    </div>
</body>
</html>